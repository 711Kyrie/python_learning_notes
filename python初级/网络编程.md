## 网编

网编 = 用来实现不同计算机上运行的程序间进行数据交互。

进程、线程都是程序（CPU）实现多任务的手段。

进程 = CPU分配资源的最小单位。
线程 = CPU调度资源的基本单位。

进程间数据隔离，线程间数据共享。

**网络编程三要素**

(1) IP地址：这是网络环境下每一台计算机的唯一标识，通过IP地址来找到指定的计算机；

(2) 端口：用于标识进程的逻辑地址，通过端口来找到指定的进程；

(3) 协议：定义通信规则，符合协议则可以通信，否则无法正常通信。



## CS架构与BS架构

【一】什么是C/S模型
C是英文单词“Client”的首字母，即客户端的意思
C/S就是“Client/Server”的缩写，即“客户端/服务器”模式。
例如：拼多多APP、PC上的有道云笔记等等
【二】什么是B/S模型
B是英文单词“Browser”的首字母，即浏览器的意思；
S是英文单词“Server”的首字母，即服务器的意思。
B/S就是“Browser/Server”的缩写
即“浏览器/服务器”模式。
例如：淘宝网、京东网等等

一些常见的互联网协议包括：
TCP/IP：传输控制协议/因特网协议，是互联网的基础协议，负责确保数据包从源节点安全、可靠地传输到目的地节点。
HTTP：超文本传输协议，是Web的主要协议，用于在客户端和服务器之间传输HTML文档和其他类型的内容。
FTP：文件传输协议，用于在计算机之间传输文件。



## socket套接字

知道网络编程的三要素，数据是如何完成传输的呢？此时，就可以使用 **socket** 来完成。

**socket**（简称 套接字）是**进程之间通信的一个工具**，好比现实生活中的**插座**，所有的家用电器要想工作都是基于插座进行，而进程之间想要进行网络通信需要基于这个 **socket**。

用于创建一个 socket 对象。其中，参数 `AddressFamily` 可以选择 **AF_INET** 用于 Internet 进程间通信，实际工作中常用它；参数 `Type` 表示套接字类型，可以是 **SOCK_STREAM** 流式套接字，主要用于 TCP 协议。

网络编程也叫网络通信，Socket 通信，即：通信双方都独有自己的 Socket 对象，数据在 Socket 之间通过 **数据报包（UDP 协议）** 或者 **字节流（TCP 协议）** 的形式进行传输。

**socket()模块函数用法**

```python
  import socket
  socket.socket(socket_family,socket_type,protocal=0)
  socket_family 可以是 AF_UNIX(本地通信（同一台机器）) 或 AF_INET(网络通信（跨机器）IPv4或v6,默认v4)。socket_type 可以是 SOCK_STREAM 或 SOCK_DGRAM。protocol 一般不填,默认值为 0。
  
 # 获取tcp/ip套接字
  tcpSock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  
 # 获取udp/ip套接字
  udpSock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

 # 由于 socket 模块中有太多的属性。我们在这里破例使用了'from module import *'语句。使用 'from socket import *',我们就把 socket 模块里的所有属性都带到我们的命名空间里了,这样能 大幅减短我们的代码。
 #  例如tcpSock = socket(AF_INET, SOCK_STREAM
```

**服务端套接字函数**

- s.bind() 绑定(主机,端口号)到套接字
- s.listen() 开始TCP监听
- s.accept() 被动接受TCP客户的连接,(阻塞式)等待连接的到来

**基于TCP的套接字**

- tcp是基于链接的
  - 必须先启动服务端
  - 然后再启动客户端去链接服务端

- tcp服务端

```python
server = socket() #创建服务器套接字
server.bind()      #把地址绑定到套接字
server.listen()      #监听链接
inf_loop:      #服务器无限循环
    conn = server.accept() #接受客户端链接
    comm_loop:         #通讯循环
        conn.recv()/conn.send() #对话(接收与发送)
    conn.close()    #关闭客户端套接字
server.close()        #关闭服务器套接字(可选)
```

- tcp客户端

```python
client = socket()    # 创建客户套接字
client.connect()    # 尝试连接服务器
comm_loop:        # 通讯循环
    client.send()/client.recv()    # 对话(发送/接收)
client.close()            # 关闭客户套接字
```

**打电话模型**

- socket通信流程与打电话流程类似
  - 我们就以打电话为例来实现一个low版的套接字通信

服务端

```python
import socket

ip_port = ('127.0.0.1', 9000)  # 电话卡
BUFSIZE = 1024  # 收发消息的尺寸
servser = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # 买手机
servser.bind(ip_port)  # 手机插卡
servser.listen(5)  # 手机待机

conn, addr = servser.accept()  # 手机接电话
# print(conn)
# print(addr)
print('接到来自%s的电话' % addr[0])

msg = conn.recv(BUFSIZE)  # 听消息,听话
print(msg, type(msg))

conn.send(msg.upper())  # 发消息,说话

conn.close()  # 挂电话

servser.close()  # 手机关机
```

客户端

```python
import socket

ip_port = ('127.0.0.1', 9000)
BUFSIZE = 1024
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

client.connect_ex(ip_port)  # 拨电话

client.send('dream is handsome'.encode('utf-8'))  # 发消息,说话(只能发送字节类型)

feedback = client.recv(BUFSIZE)  # 收消息,听话
print(feedback.decode('utf-8'))

client.close()  # 挂电话
```

